name: Release
run-name: ðŸš€ Release - ${{ github.actor }}
on:
  push:
    branches: [ main ] # TODO - change to release when testing is done
  workflow_dispatch: # allow manual triggering

jobs:
  prepare:
    uses: ./.github/workflows/build.yaml

  deploy:
    needs: prepare
    uses: ./.github/workflows/ec2.yaml
    secrets:
      EC2_USER: ${{ secrets.EC2_USER }}
      EC2_HOST: ${{ secrets.EC2_HOST }}
      EC2_KEY: ${{ secrets.EC2_KEY }}
